# Little Forum Thing (WIP)

This is an open source forum software meant to be easy to use and deploy. Work in progress.

Tech stack:

- [TypeScript](https://www.typescriptlang.org/)
- [Vue.js](https://vuejs.org/) for UI (with [Primevue](https://www.primefaces.org/primevue/) as a component library)
- [Nuxt](https://nuxt.com/) as the framework
- [Supabase](https://supabase.com/) for database, cloud storage and authentication

## Philosophy

This is meant to be a simple forum software with a small amount of configuration. At the moment, configuration is done by editing `forum-config.ts` at the root, though eventually some of those options might be moved to an admin panel and stored in the database.

## Environmnt variables

Environment variables are required for the forum to connect to supabase. The values can be found in the project settings -> API section of Supabase.

The following fields need to be added to a `.env` file at the root of the project:

```.env
SUPABASE_URL="[supabase url]"
SUPABASE_KEY="[supabase anon public key]"
```

Note: Those values are not sensitive, so they can be public without issues. The project currently doesn't require any secret keys to run.

## Development

### Prerequisites

- [Node.js](https://nodejs.org/en/) (v16 recommended)
- Environment variables need to be setup

`npm install` to install dependencies.

`npm run dev` to run the forum

## Deploying

As a nuxt app, the forum can easily be deployed to a variety of hosting platforms that support node.js. The easiest recommended way to deploy it is to use [Vercel](https://vercel.com/) which has built-in compatibility with Nuxt.

Environment variables will need to be configured for the deployment, as mentioned above.

Deploying is simply a matter of importing the project in Vercel and letting it deploy it.

## Using existing dev Supabase instance

This is the Supabase instance I currently use for testing.

Simply put this in `.env`

```
SUPABASE_URL="https://rgitljlknjfprwfejlty.supabase.co"
SUPABASE_KEY="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJnaXRsamxrbmpmcHJ3ZmVqbHR5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2Njg0NDQyNjQsImV4cCI6MTk4NDAyMDI2NH0.FdMKZVG1mCksEVPelE8QxhCr5BxwhmsNr646pegoGRo"
```

## Setting up a Supabase instance to run the forum

To use your own Supabase instance, you will need to create a [supabase](https://supabase.com/) project, add its details in the environment variables, and setup the database/storage bucket.

Note: The Supabase setup to run your own instance currently has to be done manually.

The following things need to be setup in Supabase:

- The 3 database tables
- Security policies for those tables (queries included in the `sql` folder)
- Storage bucket (query included in the `sql` folder)
- Database trigger function to add new users on auth (query included in the `sql` folder)

The aim is to eventually automate the Supabase setup so that it's all stored in git, but for now this is a work in progress.

### Creating the tables

The [lib/database.types.ts](https://github.com/liana-p/liana-forum-thing/blob/main/lib/database.types.ts) in this repo has been auto-generated by exporting the database schema from Supabase, so it can be used as a reference for the database schema.

Three tables need to be setup:

- `profiles`: Stores users
- `threads`: Stores threads. The `created_by` field is a foreign key to the `profiles` table.
- `replies`: Stores replies to threads. The `created_by` field is a foreign key to the `profiles` table, and the `thread_id` field is a foreign key to the `threads` table.

### Running queries to setup other things

The SQL folder contains queries that can be run in the Supabase SQL editor to setup security policies, triggers and the storage bucket.

The `avatars` storage bucket also needs to be made public in the Supabase UI.

# Original Nuxt-generated README below for reference

# Nuxt 3 Minimal Starter

Look at the [nuxt 3 documentation](https://v3.nuxtjs.org) to learn more.

## Setup

Make sure to install the dependencies:

```bash
# yarn
yarn install

# npm
npm install

# pnpm
pnpm install --shamefully-hoist
```

## Development Server

Start the development server on http://localhost:3000

```bash
npm run dev
```

## Production

Build the application for production:

```bash
npm run build
```

Locally preview production build:

```bash
npm run preview
```

Checkout the [deployment documentation](https://v3.nuxtjs.org/guide/deploy/presets) for more information.
